#!/usr/bin/env ruby

require "bundler/setup"
require_relative '../lib/speculation.rb'

# You can add fixtures and/or initialization code here to make experimenting
# with your gem easier. You can also use a different console, if you like.
def reload!
  Object.send :remove_const, :Speculation if Object.const_defined?(:Speculation)
  Object.send :remove_const, :S           if Object.const_defined?(:S)
  Object.send :remove_const, :STest       if Object.const_defined?(:STest)
  Object.send :remove_const, :Gen         if Object.const_defined?(:Gen)
  Object.send :remove_const, :Utils       if Object.const_defined?(:Utils)

  load './lib/speculation/namespaced_symbols.rb'
  load './lib/speculation/conj.rb'
  load './lib/speculation/identifier.rb'
  load './lib/speculation/utils.rb'
  load './lib/speculation/gen.rb'
  load './lib/speculation.rb'
  load './lib/speculation/test.rb'
  load './lib/speculation/specs.rb'

  Object.const_set(:S, Speculation)
  Object.const_set(:STest, Speculation::Test)
  Object.const_set(:Gen, Speculation::Gen)
  Object.const_set(:U, Speculation::Utils)
  Object.const_set(:H, Hamster::Hash)
  Object.const_set(:V, Hamster::Vector)

  STest.instrument
end

# allow running minitest assertions
require 'minitest'
include Minitest::Assertions
def self.assertions; 1; end
def self.assertions=(x);end

reload!

# (If you use this, don't forget to add pry to your Gemfile!)
require "pry"
Pry.start
